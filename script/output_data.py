import pandas as pd
import numpy as np
import random

# ユーザー情報
# ユーザーID
user_id_list = list(range(1, 1001))
user_id = ['A' + str(number).zfill(4) for number in user_id_list]
# print(user_id)

# 性別
gender_list = ['男性', '女性', 'その他']
gender_weights = [3, 7, 0.1]
gender = random.choices(gender_list, k=1000, weights=gender_weights)
# print(gender)

# 誕生年 値:重み
birth_list = {
    '2003': 0.5, # 18
    '2002': 0.7, # 19
    '2001': 1, # 20
    '2000': 1, # 21
    '1999': 1, # 22
    '1998': 1, # 23
    '1997': 1, # 24
    '1996': 1.1, # 25
    '1995': 1.2, # 26
    '1994': 1.3, # 27
    '1993': 1.4, # 28
    '1992': 1.5, # 29
    '1991': 2, # 30
    '1990': 2.1, # 31
    '1989': 2.1, # 32
    '1988': 2.5, # 33
    '1987': 2.8, # 34
    '1986': 3, # 35
    '1985': 3, # 36
    '1984': 3, # 37
    '1983': 2.5, # 38
    '1982': 2, # 39
    '1981': 2.1, # 40
    '1980': 2.1, # 41
    '1979': 2.2, # 42
    '1978': 2.3, # 43
    '1977': 2.3, # 44
    '1976': 2.2, # 45
    '1975': 2.2, # 46
    '1974': 2.1, # 47
    '1973': 2.1, # 48
    '1972': 2, # 49
    '1971': 2, # 50
    '1970': 1.8, # 51
    '1969': 1.8, # 52
    '1968': 1.5, # 53
    '1967': 1.5, # 54
    '1966': 1.3, # 55
    '1965': 1.3, # 56
    '1964': 1.3, # 57
    '1963': 1.3, # 58
    '1962': 1.2, # 59
    '1961': 1, # 60
    '1960': 1, # 61
    '1959': 1, # 62
    '1958': 1, # 63
    '1957': 1, # 64
    '1956': 1, # 65
    '1955': 1, # 66
    '1954': 0.9, # 67
    '1953': 0.9, # 68
    '1952': 0.8, # 69
    '1951': 0.7, # 70
    '1950': 0.7, # 71
    '1949': 0.7, # 72
    '1948': 0.6, # 73
    '1947': 0.5, # 74
    '1946': 0.5, # 75
    '1945': 0.4, # 76
    '1944': 0.3, # 77
    '1943': 0.3, # 78
    '1942': 0.2, # 79
    '1941': 0.1, # 80
}
birth = random.choices(list(birth_list.keys()), k=1000, weights=list(birth_list.values()))

# 削除フラグ
delete_flag_list = [0, 1]
delete_flag_weights = [300, 1]
delete_flag = random.choices(delete_flag_list, k=1000, weights=delete_flag_weights)

# ユーザーデータをcsvに抽出
df_user = pd.DataFrame({
    'user_id': user_id,
    'gender': gender,
    'birth': birth,
    'is_deleted': delete_flag,
}).set_index('user_id')
print(df_user.head())
df_user.to_csv('users.csv')

# 商品データ
# docker上のパス
product = pd.read_csv('./script/data/products_weight.csv')
prodcut_id_list = list(product['product_id'])
product_id_weight = list(product['weight'])

# 購入データ
order_id_list = list(range(1, 100001))
order_id = ['C' + str(number).zfill(6) for number in order_id_list]
order_product_id = random.choices(prodcut_id_list, k=100000, weights=product_id_weight)
discount_flag_list = [0, 1]
discount_flag_weights = [30, 1]
discount_flag = random.choices(discount_flag_list, k=100000, weights=discount_flag_weights)
# 購入日 値:重み
order_date_list = {
    '2022-01-01': 4,
    '2022-01-02': 3,
    '2022-01-03': 2,
    '2022-01-04': 1,
    '2022-01-05': 1,
    '2022-01-06': 1,
    '2022-01-07': 1,
    '2022-01-08': 1,
    '2022-01-09': 1,
    '2022-01-10': 1,
    '2022-01-11': 1,
    '2022-01-12': 1,
    '2022-01-13': 1,
    '2022-01-14': 1,
    '2022-01-15': 1,
    '2022-01-16': 1,
    '2022-01-17': 1,
    '2022-01-18': 1,
    '2022-01-19': 1,
    '2022-01-20': 1,
    '2022-01-21': 1,
    '2022-01-22': 1,
    '2022-01-23': 1,
    '2022-01-24': 2,
    '2022-01-25': 3,
    '2022-01-26': 3,
    '2022-01-27': 1,
    '2022-01-28': 1,
    '2022-01-29': 1,
    '2022-01-30': 1,
    '2022-01-31': 1,
    '2022-02-01': 1,
    '2022-02-02': 1,
    '2022-02-03': 1,
    '2022-02-04': 1,
    '2022-02-05': 1,
    '2022-02-06': 1,
    '2022-02-07': 1,
    '2022-02-08': 1,
    '2022-02-09': 1,
    '2022-02-10': 1,
    '2022-02-11': 1,
    '2022-02-12': 1,
    '2022-02-13': 1,
    '2022-02-14': 1,
    '2022-02-15': 1,
    '2022-02-16': 1,
    '2022-02-17': 1,
    '2022-02-18': 1,
    '2022-02-19': 1,
    '2022-02-20': 1,
    '2022-02-21': 1,
    '2022-02-22': 1,
    '2022-02-23': 1,
    '2022-02-24': 1,
    '2022-02-25': 2,
    '2022-02-26': 2,
    '2022-02-27': 1,
    '2022-02-28': 1,
    '2022-03-01': 1,
    '2022-03-02': 1,
    '2022-03-03': 1,
    '2022-03-04': 1,
    '2022-03-05': 1,
    '2022-03-06': 1,
    '2022-03-07': 1,
    '2022-03-08': 1,
    '2022-03-09': 1,
    '2022-03-10': 1,
    '2022-03-11': 1,
    '2022-03-12': 1,
    '2022-03-13': 1,
    '2022-03-14': 1,
    '2022-03-15': 1,
    '2022-03-16': 1,
    '2022-03-17': 1,
    '2022-03-18': 1,
    '2022-03-19': 1,
    '2022-03-20': 1,
    '2022-03-21': 1,
    '2022-03-22': 1,
    '2022-03-23': 1,
    '2022-03-24': 1,
    '2022-03-25': 2,
    '2022-03-26': 2,
    '2022-03-27': 1,
    '2022-03-28': 1,
    '2022-03-29': 1,
    '2022-03-30': 1,
    '2022-03-31': 1,
    '2022-04-01': 1,
    '2022-04-02': 1,
    '2022-04-03': 1,
    '2022-04-04': 1,
    '2022-04-05': 1,
    '2022-04-06': 1,
    '2022-04-07': 1,
    '2022-04-08': 1,
    '2022-04-09': 1,
    '2022-04-10': 1,
    '2022-04-11': 1,
    '2022-04-12': 1,
    '2022-04-13': 1,
    '2022-04-14': 1,
    '2022-04-15': 1,
    '2022-04-16': 1,
    '2022-04-17': 1,
    '2022-04-18': 1,
    '2022-04-19': 1,
    '2022-04-20': 1,
    '2022-04-21': 1,
    '2022-04-22': 1,
    '2022-04-23': 1,
    '2022-04-24': 2,
    '2022-04-25': 3,
    '2022-04-26': 3,
    '2022-04-27': 1,
    '2022-04-28': 1,
    '2022-04-29': 1,
    '2022-04-30': 1,
    '2022-05-01': 1,
    '2022-05-02': 2,
    '2022-05-03': 3,
    '2022-05-04': 3,
    '2022-05-05': 2,
    '2022-05-06': 2,
    '2022-05-07': 1,
    '2022-05-08': 1,
    '2022-05-09': 1,
    '2022-05-10': 1,
    '2022-05-11': 1,
    '2022-05-12': 1,
    '2022-05-13': 1,
    '2022-05-14': 1,
    '2022-05-15': 1,
    '2022-05-16': 1,
    '2022-05-17': 1,
    '2022-05-18': 1,
    '2022-05-19': 1,
    '2022-05-20': 1,
    '2022-05-21': 1,
    '2022-05-22': 1,
    '2022-05-23': 1,
    '2022-05-24': 1,
    '2022-05-25': 2,
    '2022-05-26': 2,
    '2022-05-27': 1,
    '2022-05-28': 1,
    '2022-05-29': 1,
    '2022-05-30': 1,
    '2022-05-31': 1,
    '2022-06-01': 1,
    '2022-06-02': 1,
    '2022-06-03': 1,
    '2022-06-04': 1,
    '2022-06-05': 1,
    '2022-06-06': 1,
    '2022-06-07': 1,
    '2022-06-08': 1,
    '2022-06-09': 1,
    '2022-06-10': 1,
    '2022-06-11': 1,
    '2022-06-12': 1,
    '2022-06-13': 1,
    '2022-06-14': 1,
    '2022-06-15': 1,
    '2022-06-16': 1,
    '2022-06-17': 1,
    '2022-06-18': 1,
    '2022-06-19': 1,
    '2022-06-20': 1,
    '2022-06-21': 1,
    '2022-06-22': 1,
    '2022-06-23': 1,
    '2022-06-24': 1,
    '2022-06-25': 2,
    '2022-06-26': 1,
    '2022-06-27': 1,
    '2022-06-28': 1,
    '2022-06-29': 1,
    '2022-06-30': 1,
    '2022-07-01': 1,
    '2022-07-02': 1,
    '2022-07-03': 1,
    '2022-07-04': 1,
    '2022-07-05': 1,
    '2022-07-06': 1,
    '2022-07-07': 1,
    '2022-07-08': 1,
    '2022-07-09': 1,
    '2022-07-10': 1,
    '2022-07-11': 1,
    '2022-07-12': 1,
    '2022-07-13': 1,
    '2022-07-14': 1,
    '2022-07-15': 1,
    '2022-07-16': 1,
    '2022-07-17': 1,
    '2022-07-18': 1,
    '2022-07-19': 1,
    '2022-07-20': 1,
    '2022-07-21': 1,
    '2022-07-22': 2,
    '2022-07-23': 2,
    '2022-07-24': 2,
    '2022-07-25': 1,
    '2022-07-26': 1,
    '2022-07-27': 1,
    '2022-07-28': 1,
    '2022-07-29': 1,
    '2022-07-30': 1,
    '2022-07-31': 1,
    '2022-08-01': 1,
    '2022-08-02': 1,
    '2022-08-03': 1,
    '2022-08-04': 1,
    '2022-08-05': 1,
    '2022-08-06': 1,
    '2022-08-07': 1,
    '2022-08-08': 1,
    '2022-08-09': 1,
    '2022-08-10': 1,
    '2022-08-11': 1,
    '2022-08-12': 1,
    '2022-08-13': 1,
    '2022-08-14': 1,
    '2022-08-15': 1,
    '2022-08-16': 1,
    '2022-08-17': 1,
    '2022-08-18': 1,
    '2022-08-19': 1,
    '2022-08-20': 1,
    '2022-08-21': 1,
    '2022-08-22': 1,
    '2022-08-23': 1,
    '2022-08-24': 1,
    '2022-08-25': 2,
    '2022-08-26': 2,
    '2022-08-27': 1,
    '2022-08-28': 1,
    '2022-08-29': 1,
    '2022-08-30': 1,
    '2022-08-31': 1,
    '2022-09-01': 1,
    '2022-09-02': 1,
    '2022-09-03': 1,
    '2022-09-04': 1,
    '2022-09-05': 1,
    '2022-09-06': 1,
    '2022-09-07': 1,
    '2022-09-08': 1,
    '2022-09-09': 1,
    '2022-09-10': 1,
    '2022-09-11': 1,
    '2022-09-12': 1,
    '2022-09-13': 1,
    '2022-09-14': 1,
    '2022-09-15': 1,
    '2022-09-16': 1,
    '2022-09-17': 1,
    '2022-09-18': 1,
    '2022-09-19': 1,
    '2022-09-20': 1,
    '2022-09-21': 1,
    '2022-09-22': 1,
    '2022-09-23': 1,
    '2022-09-24': 1,
    '2022-09-25': 2,
    '2022-09-26': 2,
    '2022-09-27': 1,
    '2022-09-28': 1,
    '2022-09-29': 1,
    '2022-09-30': 1,
    '2022-10-01': 1,
    '2022-10-02': 1,
    '2022-10-03': 1,
    '2022-10-04': 1,
    '2022-10-05': 1,
    '2022-10-06': 1,
    '2022-10-07': 1,
    '2022-10-08': 1,
    '2022-10-09': 1,
    '2022-10-10': 1,
    '2022-10-11': 1,
    '2022-10-12': 1,
    '2022-10-13': 1,
    '2022-10-14': 1,
    '2022-10-15': 1,
    '2022-10-16': 1,
    '2022-10-17': 1,
    '2022-10-18': 1,
    '2022-10-19': 1,
    '2022-10-20': 1,
    '2022-10-21': 1,
    '2022-10-22': 1,
    '2022-10-23': 2,
    '2022-10-24': 2,
    '2022-10-25': 1,
    '2022-10-26': 1,
    '2022-10-27': 1,
    '2022-10-28': 1,
    '2022-10-29': 1,
    '2022-10-30': 1,
    '2022-10-31': 1,
    '2022-11-01': 1,
    '2022-11-02': 1,
    '2022-11-03': 1,
    '2022-11-04': 1,
    '2022-11-05': 1,
    '2022-11-06': 1,
    '2022-11-07': 1,
    '2022-11-08': 1,
    '2022-11-09': 1,
    '2022-11-10': 1,
    '2022-11-11': 1,
    '2022-11-12': 1,
    '2022-11-13': 1,
    '2022-11-14': 1,
    '2022-11-15': 1,
    '2022-11-16': 1,
    '2022-11-17': 1,
    '2022-11-18': 1,
    '2022-11-19': 1,
    '2022-11-20': 1,
    '2022-11-21': 1,
    '2022-11-22': 1,
    '2022-11-23': 1,
    '2022-11-24': 1,
    '2022-11-25': 2,
    '2022-11-26': 1,
    '2022-11-27': 1,
    '2022-11-28': 1,
    '2022-11-29': 1,
    '2022-11-30': 1,
    '2022-12-01': 1,
    '2022-12-02': 1,
    '2022-12-03': 1,
    '2022-12-04': 1,
    '2022-12-05': 1,
    '2022-12-06': 1,
    '2022-12-07': 1,
    '2022-12-08': 1,
    '2022-12-09': 1,
    '2022-12-10': 1,
    '2022-12-11': 1,
    '2022-12-12': 1,
    '2022-12-13': 1,
    '2022-12-14': 1,
    '2022-12-15': 1,
    '2022-12-16': 1,
    '2022-12-17': 1,
    '2022-12-18': 1,
    '2022-12-19': 1,
    '2022-12-20': 1,
    '2022-12-21': 1,
    '2022-12-22': 1,
    '2022-12-23': 1,
    '2022-12-24': 3,
    '2022-12-25': 4,
    '2022-12-26': 5,
    '2022-12-27': 4,
    '2022-12-28': 1,
    '2022-12-29': 1,
    '2022-12-30': 1,
    '2022-12-31': 1,
}
order_date = random.choices(list(order_date_list.keys()), k=100000, weights=list(order_date_list.values()))

# キャンセルフラグ
cancel_flag_list = [0, 1]
cancel_flag_weights = [3000, 1]
cancel_flag = random.choices(cancel_flag_list, k=100000, weights=cancel_flag_weights)

# 購入ユーザーの重み
order_user_weight_list = [0, 1, 5, 10]
order_user_weight_list_weight = [8, 5, 3, 1]
# ユーザーID+1の数だけ重みをの値を生成
order_user_id_weight = random.choices(order_user_weight_list, k=1001, weights=order_user_weight_list_weight)
# 未ログインでの購入を想定してNULLを追加
user_id_add_null = user_id + ['']
order_user_id = random.choices(user_id_add_null, k=100000, weights=order_user_id_weight)

# 購入データをcsvに抽出
df_order = pd.DataFrame({
    'order_id': order_id,
    'user_id': order_user_id,
    'order_product_id': order_product_id,
    'order_date': order_date,
    'is_discounted': discount_flag,
    'is_canceled': cancel_flag,
}).set_index('order_id')
print(df_order.head())
df_order.to_csv('orders.csv')
